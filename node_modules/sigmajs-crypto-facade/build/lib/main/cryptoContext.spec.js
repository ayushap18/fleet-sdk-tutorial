"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const cryptoContext_1 = require("./cryptoContext");
const noble_secp256k1_1 = require("./noble-secp256k1");
describe("Crypto context", () => {
    const context = new cryptoContext_1.CryptoContext();
    const modulus = 115792089237316195423570985008687907853269984665640564039457584007908834671663n;
    const order = 115792089237316195423570985008687907852837564279074904382605163141518161494337n;
    const generatorPointHex = "0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798";
    const p1 = {
        hex: "0381c5275b1d50c39a0c36c4561c3a37bff1d87e37a9ad69eab029e426c0b1a8ac",
        x: 58696697963552658225209022604545906839720992139040109583461478932841590007980n,
        y: 99221890655421281687240657051313379827030356718751695543666346070432252019955n
    };
    it("Should get modulus", () => {
        expect(context.getModulus()).toBe(modulus);
    });
    it("Should get order", () => {
        expect(context.getOrder()).toBe(order);
    });
    it("Should validate points", () => {
        expect(context.validatePoint(p1.x, p1.y)).toEqual(new noble_secp256k1_1.Point(p1.x, p1.y));
        expect(context.validatePoint(1n, 2n)).toBeFalsy();
    });
    it("Should get infinity point", () => {
        expect(context.getInfinity().toHex(true)).toBe(noble_secp256k1_1.Point.ZERO.toHex(true));
    });
    it("Should decode a point", () => {
        const decodedPoint = context.decodePoint(Buffer.from(p1.hex, "hex"));
        expect(decodedPoint.x).toBe(p1.x);
        expect(decodedPoint.y).toBe(p1.y);
    });
    it("Should get generator point", () => {
        expect(context.getGenerator().toHex(true)).toBe(generatorPointHex);
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3J5cHRvQ29udGV4dC5zcGVjLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2NyeXB0b0NvbnRleHQuc3BlYy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLG1EQUFnRDtBQUNoRCx1REFBMEM7QUFFMUMsUUFBUSxDQUFDLGdCQUFnQixFQUFFLEdBQUcsRUFBRTtJQUM5QixNQUFNLE9BQU8sR0FBRyxJQUFJLDZCQUFhLEVBQUUsQ0FBQztJQUNwQyxNQUFNLE9BQU8sR0FBRywrRUFBK0UsQ0FBQztJQUNoRyxNQUFNLEtBQUssR0FBRywrRUFBK0UsQ0FBQztJQUM5RixNQUFNLGlCQUFpQixHQUFHLG9FQUFvRSxDQUFDO0lBRS9GLE1BQU0sRUFBRSxHQUFHO1FBQ1QsR0FBRyxFQUFFLG9FQUFvRTtRQUN6RSxDQUFDLEVBQUUsOEVBQThFO1FBQ2pGLENBQUMsRUFBRSw4RUFBOEU7S0FDbEYsQ0FBQztJQUVGLEVBQUUsQ0FBQyxvQkFBb0IsRUFBRSxHQUFHLEVBQUU7UUFDNUIsTUFBTSxDQUFDLE9BQU8sQ0FBQyxVQUFVLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUM3QyxDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyxrQkFBa0IsRUFBRSxHQUFHLEVBQUU7UUFDMUIsTUFBTSxDQUFDLE9BQU8sQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUN6QyxDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyx3QkFBd0IsRUFBRSxHQUFHLEVBQUU7UUFDaEMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsSUFBSSx1QkFBSyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDekUsTUFBTSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsU0FBUyxFQUFFLENBQUM7SUFDcEQsQ0FBQyxDQUFDLENBQUM7SUFFSCxFQUFFLENBQUMsMkJBQTJCLEVBQUUsR0FBRyxFQUFFO1FBQ25DLE1BQU0sQ0FBQyxPQUFPLENBQUMsV0FBVyxFQUFFLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLHVCQUFLLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO0lBQ3pFLENBQUMsQ0FBQyxDQUFDO0lBRUgsRUFBRSxDQUFDLHVCQUF1QixFQUFFLEdBQUcsRUFBRTtRQUMvQixNQUFNLFlBQVksR0FBRyxPQUFPLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxLQUFLLENBQUMsQ0FBQyxDQUFDO1FBRXJFLE1BQU0sQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNsQyxNQUFNLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDcEMsQ0FBQyxDQUFDLENBQUM7SUFFSCxFQUFFLENBQUMsNEJBQTRCLEVBQUUsR0FBRyxFQUFFO1FBQ3BDLE1BQU0sQ0FBQyxPQUFPLENBQUMsWUFBWSxFQUFFLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLENBQUM7SUFDckUsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyJ9