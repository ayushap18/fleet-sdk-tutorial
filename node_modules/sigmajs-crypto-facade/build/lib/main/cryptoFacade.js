"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.CryptoFacade = void 0;
const hmac_1 = require("@noble/hashes/hmac");
const pbkdf2_1 = require("@noble/hashes/pbkdf2");
const sha512_1 = require("@noble/hashes/sha512");
const cryptoContext_1 = require("./cryptoContext");
const noble_secp256k1_1 = require("./noble-secp256k1");
class CryptoFacade {
    static normalizePoint(point) {
        return noble_secp256k1_1.Point.fromHex(point.toHex());
    }
    static createCryptoContext() {
        return new cryptoContext_1.CryptoContext();
    }
    static negatePoint(point) {
        return point.negate();
    }
    static isInfinityPoint(point) {
        return point.equals(noble_secp256k1_1.Point.ZERO);
    }
    static multiplyPoint(point, scalar) {
        return point.multiply(scalar);
    }
    static addPoint(point1, point2) {
        return point1.add(point2);
    }
    static showPoint(point) {
        const x = point.x.toString(16).substring(0, 6);
        const y = point.y.toString(16).substring(0, 6);
        return `ECPoint(${x},${y},...)`;
    }
    static testBitZeroOfFieldElem(element) {
        return this._testBitOfFieldElem(element, 0);
    }
    static _testBitOfFieldElem(element, index) {
        return (element & BigInt(1 << index)) !== 0n;
    }
    static getEncodedOfFieldElem(element) {
        return noble_secp256k1_1.utils._bigintTo32Bytes(element);
    }
    static getXCoord(point) {
        return point.x;
    }
    static getYCoord(point) {
        return point.y;
    }
    static getAffineXCoord(point) {
        return point.x;
    }
    static getAffineYCoord(point) {
        return point.y;
    }
    static hashHmacSHA512(key, data) {
        return (0, hmac_1.hmac)(sha512_1.sha512, key, data);
    }
    static generatePbkdf2Key(normalizedMnemonic, normalizedPass) {
        return (0, pbkdf2_1.pbkdf2)(sha512_1.sha512, normalizedMnemonic, normalizedPass, { c: 2048, dkLen: 64 });
    }
    static normalizeChars(chars) {
        return chars.normalize("NFKD");
    }
    static getRandomBytes(length = 32) {
        return noble_secp256k1_1.utils.randomBytes(length);
    }
}
exports.CryptoFacade = CryptoFacade;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3J5cHRvRmFjYWRlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2NyeXB0b0ZhY2FkZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSw2Q0FBMEM7QUFDMUMsaURBQThDO0FBQzlDLGlEQUE4QztBQUM5QyxtREFBZ0Q7QUFDaEQsdURBQWlEO0FBRWpELE1BQWEsWUFBWTtJQUN2QixNQUFNLENBQUMsY0FBYyxDQUFDLEtBQVk7UUFDaEMsT0FBTyx1QkFBSyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQztJQUN0QyxDQUFDO0lBRUQsTUFBTSxDQUFDLG1CQUFtQjtRQUN4QixPQUFPLElBQUksNkJBQWEsRUFBRSxDQUFDO0lBQzdCLENBQUM7SUFFRCxNQUFNLENBQUMsV0FBVyxDQUFDLEtBQVk7UUFDN0IsT0FBTyxLQUFLLENBQUMsTUFBTSxFQUFFLENBQUM7SUFDeEIsQ0FBQztJQUVELE1BQU0sQ0FBQyxlQUFlLENBQUMsS0FBWTtRQUNqQyxPQUFPLEtBQUssQ0FBQyxNQUFNLENBQUMsdUJBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUNsQyxDQUFDO0lBRUQsTUFBTSxDQUFDLGFBQWEsQ0FBQyxLQUFZLEVBQUUsTUFBYztRQUMvQyxPQUFPLEtBQUssQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDaEMsQ0FBQztJQUVELE1BQU0sQ0FBQyxRQUFRLENBQUMsTUFBYSxFQUFFLE1BQWE7UUFDMUMsT0FBTyxNQUFNLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQzVCLENBQUM7SUFFRCxNQUFNLENBQUMsU0FBUyxDQUFDLEtBQVk7UUFDM0IsTUFBTSxDQUFDLEdBQUcsS0FBSyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUMvQyxNQUFNLENBQUMsR0FBRyxLQUFLLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBRS9DLE9BQU8sV0FBVyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUM7SUFDbEMsQ0FBQztJQUVELE1BQU0sQ0FBQyxzQkFBc0IsQ0FBQyxPQUFlO1FBQzNDLE9BQU8sSUFBSSxDQUFDLG1CQUFtQixDQUFDLE9BQU8sRUFBRSxDQUFDLENBQUMsQ0FBQztJQUM5QyxDQUFDO0lBRU8sTUFBTSxDQUFDLG1CQUFtQixDQUFDLE9BQWUsRUFBRSxLQUFhO1FBQy9ELE9BQU8sQ0FBQyxPQUFPLEdBQUcsTUFBTSxDQUFDLENBQUMsSUFBSSxLQUFLLENBQUMsQ0FBQyxLQUFLLEVBQUUsQ0FBQztJQUMvQyxDQUFDO0lBRUQsTUFBTSxDQUFDLHFCQUFxQixDQUFDLE9BQWU7UUFDMUMsT0FBTyx1QkFBSyxDQUFDLGdCQUFnQixDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ3pDLENBQUM7SUFFRCxNQUFNLENBQUMsU0FBUyxDQUFDLEtBQVk7UUFDM0IsT0FBTyxLQUFLLENBQUMsQ0FBQyxDQUFDO0lBQ2pCLENBQUM7SUFFRCxNQUFNLENBQUMsU0FBUyxDQUFDLEtBQVk7UUFDM0IsT0FBTyxLQUFLLENBQUMsQ0FBQyxDQUFDO0lBQ2pCLENBQUM7SUFFRCxNQUFNLENBQUMsZUFBZSxDQUFDLEtBQVk7UUFDakMsT0FBTyxLQUFLLENBQUMsQ0FBQyxDQUFDO0lBQ2pCLENBQUM7SUFFRCxNQUFNLENBQUMsZUFBZSxDQUFDLEtBQVk7UUFDakMsT0FBTyxLQUFLLENBQUMsQ0FBQyxDQUFDO0lBQ2pCLENBQUM7SUFFRCxNQUFNLENBQUMsY0FBYyxDQUFDLEdBQWUsRUFBRSxJQUFnQjtRQUNyRCxPQUFPLElBQUEsV0FBSSxFQUFDLGVBQU0sRUFBRSxHQUFHLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDakMsQ0FBQztJQUVELE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxrQkFBMEIsRUFBRSxjQUFzQjtRQUN6RSxPQUFPLElBQUEsZUFBTSxFQUFDLGVBQU0sRUFBRSxrQkFBa0IsRUFBRSxjQUFjLEVBQUUsRUFBRSxDQUFDLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDO0lBQ3BGLENBQUM7SUFFRCxNQUFNLENBQUMsY0FBYyxDQUFDLEtBQWE7UUFDakMsT0FBTyxLQUFLLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ2pDLENBQUM7SUFFRCxNQUFNLENBQUMsY0FBYyxDQUFDLE1BQU0sR0FBRyxFQUFFO1FBQy9CLE9BQU8sdUJBQUssQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDbkMsQ0FBQztDQUNGO0FBM0VELG9DQTJFQyJ9